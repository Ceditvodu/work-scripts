<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<style>
	.spoiler{
		border: 1px solid black;

	}
	.spoiler .title{
		border: 1px solid red;
	}
</style>
<body>
<div>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis id explicabo quam quo nisi nihil ducimus, possimus, in aperiam, optio repellat commodi labore. Voluptatibus explicabo tempore sapiente repudiandae! Magni, modi.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque doloribus aliquam velit porro, harum est repellendus aperiam consequatur omnis eos vero vel placeat facere enim amet ex quae accusamus nisi.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint nostrum est assumenda non porro, reiciendis, dolor dolorem maxime odio libero eius pariatur vero totam numquam fuga tempore ex obcaecati adipisci.</p>
</div>
<div class="spoiler">
	<div class="title">
		Lorem ipsum dolor sit amet, consectetur adipisicing elit.
	</div>
	<div class="content">

			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis id explicabo quam quo nisi nihil ducimus, possimus, in aperiam, optio repellat commodi labore. Voluptatibus explicabo tempore sapiente repudiandae! Magni, modi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque doloribus aliquam velit porro, harum est repellendus aperiam consequatur omnis eos vero vel placeat facere enim amet ex quae accusamus nisi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint nostrum est assumenda non porro, reiciendis, dolor dolorem maxime odio libero eius pariatur vero totam numquam fuga tempore ex obcaecati adipisci.</p>	
			

	</div>
</div>

<div class="spoiler1">
	<div class="title2">
		Lorem ipsum dolor sit amet, consectetur adipisicing elit.
	</div>
	<div class="content3">

			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis id explicabo quam quo nisi nihil ducimus, possimus, in aperiam, optio repellat commodi labore. Voluptatibus explicabo tempore sapiente repudiandae! Magni, modi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque doloribus aliquam velit porro, harum est repellendus aperiam consequatur omnis eos vero vel placeat facere enim amet ex quae accusamus nisi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint nostrum est assumenda non porro, reiciendis, dolor dolorem maxime odio libero eius pariatur vero totam numquam fuga tempore ex obcaecati adipisci.</p>	
			

	</div>
</div>

<div class="spoiler">
	<div class="title">
		Lorem ipsum dolor sit amet, consectetur adipisicing elit.
	</div>
	<div class="content">

			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis id explicabo quam quo nisi nihil ducimus, possimus, in aperiam, optio repellat commodi labore. Voluptatibus explicabo tempore sapiente repudiandae! Magni, modi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque doloribus aliquam velit porro, harum est repellendus aperiam consequatur omnis eos vero vel placeat facere enim amet ex quae accusamus nisi.</p>
			<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint nostrum est assumenda non porro, reiciendis, dolor dolorem maxime odio libero eius pariatur vero totam numquam fuga tempore ex obcaecati adipisci.</p>	
			

	</div>
</div>
<div>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis id explicabo quam quo nisi nihil ducimus, possimus, in aperiam, optio repellat commodi labore. Voluptatibus explicabo tempore sapiente repudiandae! Magni, modi.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque doloribus aliquam velit porro, harum est repellendus aperiam consequatur omnis eos vero vel placeat facere enim amet ex quae accusamus nisi.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint nostrum est assumenda non porro, reiciendis, dolor dolorem maxime odio libero eius pariatur vero totam numquam fuga tempore ex obcaecati adipisci.</p>
</div>
</body>
</html>

<script>
'use strict'
/**
	* Simple spoiler
	* @author Ivan Kaduk
	* @copyright Ivan Kaduk 2016.
	* @class
	* 
	* @classdesc this class will create spoiler.
	* @param {String} className - class of div wich containe spoiler child elements.
	* @param {String} status - start status of spoiler, it can be 'opened' or 'closed'.
	* @param {String} title - class of spoiler button
	* @param {String} content - class of spoiler content div
	*/

	var Spoiler = function(className, status, title, content){
		
		// spoiler parametrs initialization
		// standart parametrs for all elements with same className
		this.spoilerName = className;
		if(title != undefined)
		{
			this.spoilerTitle = title;
		}
		else
		{
			this.spoilerTitle = 'title';
		}

		if(content != undefined)
		{
			this.spoilerContentName = content;
		}
		else
		{
			this.spoilerContentName = 'content';
		}

		// Unique parametres for every spoiler element on page with same className
		// variable arrays innitialization, for every element
		this.spoiler = new Array();
		this.title = new Array();
		this.content = new Array();
		this.contentHeight = new Array();
		this.helper = new Array();
		this.contentBody = new Array();
		this.spoilerStatus = new Array();

		// start of Unique innitialization
		for (var i = 0; i < document.getElementsByClassName(this.spoilerName).length; i++) 
		{
			this.spoiler[i] = document.getElementsByClassName(this.spoilerName)[i];

			if(status != undefined)
			{
				this.spoilerStatus[i] = status;
			}
			else
			{
				this.spoilerStatus[i] = 'closed';
			}

			// manipulation with title 
			if(this.title[i] = this.spoiler[i].getElementsByClassName(this.spoilerTitle)[0])
			{
				if(this.spoilerStatus[i] == 'opened')
				{
					this.title[i].className = this.spoilerTitle+' opened';
				}
				else if(this.spoilerStatus[i] == "closed")
				{
					this.title[i].className = this.spoilerTitle+' closed';
				}
			}
			else
			{
				console.log('errore! title is not set');
			}

			// manipulation with content
			if(this.content[i] = this.spoiler[i].getElementsByClassName(this.spoilerContentName)[0]){

				// adding helping element for correcting hight wich will be get
				this.helper = this.content[i].innerHTML;
				this.content[i].innerHTML = '';
				this.contentBody[i] = document.createElement('div');
				this.contentBody[i].innerHTML = this.helper;
				this.contentBody[i].style.position = 'relative';
				this.contentBody[i].style.overflow = 'hidden';
				this.content[i].appendChild(this.contentBody[i]);

				// getting of hight
				this.contentHeight[i] = this.content[i].clientHeight;

				if(this.spoilerStatus[i] == 'opened')
				{
					this.content[i].style.height = this.contentHeight[i]+'px';
				}
				else if(this.spoilerStatus[i] == "closed")
				{
					this.content[i].style.height = '0px';
				}
				this.content[i].style.overflow = 'hidden';
			}
			else
			{
				console.log('errore! content is not set');
			}

			// innitialization of on click function for title
			this.title[i].content = this.content[i];
			this.title[i].contentHeight = this.contentHeight[i];
			this.title[i].titleName = this.spoilerTitle;
			this.title[i].object = this;
			this.title[i].index = i;
			this.title[i].onclick = function()
			{
				if(spoilerStatusCheck(this.object, this.index) == 'closed')
				{
					slide(this.content,'down', this.contentHeight, this.index, this.object);
					this.className = this.titleName + ' opened';
				}
				else if(spoilerStatusCheck(this.object, this.index) == 'opened')
				{
					slide(this.content,'up', this.contentHeight, this.index, this.object);
					this.className = this.titleName + ' closed';
				}
			}
		};

		/**
			* @function
			* @name spoilerStatusCheck
			* @param {Spoiler} object - object that contain all initialized parametrs
			* @param {int} index -  
			*	@return
			*/
		function spoilerStatusCheck(object, index)
		{
			return object.spoilerStatus[index];
		}

		function spoilerStatusChange(object, index)
		{
			if (object.spoilerStatus[index] == 'opened') 
			{
				object.spoilerStatus[index] = 'closed';
			} 
			else
			{
				object.spoilerStatus[index] = 'opened';
			};
		}

		function slide(content, diraction, originalHeight, index, object)
		{
			var interval = setInterval(function(content, diraction)
			{
				if(diraction == 'up')
				{
					var height = content.clientHeight;
					var finale_height = height - 10;
					if(finale_height < 0)
					{
						finale_height = 0
					}
					content.style.height = finale_height + 'px';

					if(height <= 0)
					{
						content.style.height = '0px';
 						spoilerStatusChange(object,index);
 						clearInterval(interval);
					}
				}
				else if(diraction == 'down')
				{
					var height = content.clientHeight;
					content.style.height = height + 10 + 'px';
					if(height >= originalHeight)
					{
						content.style.height = originalHeight + 'px';
						spoilerStatusChange(object,index);
 						clearInterval(interval);
					}
				}
			}, 1, content, diraction)
		}
	}

	var spoiler = new Spoiler('spoiler','opened');
	var spoiler2 = new Spoiler('spoiler1','closed','title2','content3');
</script>
